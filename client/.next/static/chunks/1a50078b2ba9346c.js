(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,43184,e=>{"use strict";var t=e.i(10977);let r=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},s=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,t.forwardRef)(({color:e="currentColor",size:r=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:n="",children:o,iconNode:d,...c},m)=>(0,t.createElement)("svg",{ref:m,...a,width:r,height:r,stroke:e,strokeWidth:l?24*Number(i)/Number(r):i,className:s("lucide",n),...!o&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(c)&&{"aria-hidden":"true"},...c},[...d.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(o)?o:[o]])),l=(e,a)=>{let l=(0,t.forwardRef)(({className:l,...n},o)=>(0,t.createElement)(i,{ref:o,iconNode:a,className:s(`lucide-${r(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,l),...n}));return l.displayName=r(e),l};e.s(["default",()=>l],43184)},44612,e=>{"use strict";var t=e.i(66497),r=e.i(10977);let s=(0,r.createContext)();function a({children:e}){let[a,i]=(0,r.useState)([]),[l,n]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=localStorage.getItem("cart");if(e)try{i(JSON.parse(e))}catch(e){console.error("Failed to parse cart",e)}},[]),(0,r.useEffect)(()=>{localStorage.setItem("cart",JSON.stringify(a))},[a]);let o=a.reduce((e,t)=>e+t.price*t.quantity,0),d=a.reduce((e,t)=>e+t.quantity,0);return(0,t.jsx)(s.Provider,{value:{cart:a,addToCart:(e,t)=>{i(r=>r.find(r=>r.id===(e._id||e.id)&&r.size===t)?r.map(r=>r.id===(e._id||e.id)&&r.size===t?{...r,quantity:r.quantity+1}:r):[...r,{id:e._id||e.id,name:e.name,price:e.price,image:e.image,size:t,quantity:1,category:e.category}]),n(!0)},removeFromCart:(e,t)=>{i(r=>r.filter(r=>r.id!==e||r.size!==t))},updateQuantity:(e,t,r)=>{i(s=>s.map(s=>{if(s.id===e&&s.size===t){let e="increase"===r?s.quantity+1:s.quantity-1;return e>0?{...s,quantity:e}:s}return s}))},clearCart:()=>i([]),isCartOpen:l,setIsCartOpen:n,cartTotal:o,cartCount:d},children:e})}e.s(["CartProvider",()=>a,"useCart",0,()=>(0,r.useContext)(s)])},50738,e=>{"use strict";let t=(0,e.i(43184).default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["X",()=>t],50738)},35822,e=>{"use strict";let t=(0,e.i(43184).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>t],35822)},54628,e=>{"use strict";var t=e.i(66497),r=e.i(10977),s=e.i(44612),a=e.i(50738),i=e.i(35822),l=e.i(43184);let n=(0,l.default)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),o=(0,l.default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),d=(0,l.default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);function c(){let{cart:e,removeFromCart:l,updateQuantity:c,isCartOpen:m,setIsCartOpen:u,cartTotal:h,clearCart:x}=(0,s.useCart)(),[p,y]=(0,r.useState)("mombasa"),[f,b]=(0,r.useState)(""),[g,j]=(0,r.useState)(!1),[v,w]=(0,r.useState)({text:"",type:""}),N=450*("other"===p),k=h+N,C=async()=>{if(!f||!/^254\d{9}$/.test(f))return void w({text:"Please enter a valid M-Pesa number (e.g., 254712345678).",type:"error"});if(0===e.length)return void w({text:"Your cart is empty.",type:"error"});j(!0),w({text:"Processing payment...",type:"info"});try{let e=await fetch("http://localhost:5000/api/mpesa/stkpush",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:f,amount:k})}),t=await e.json();if(!e.ok)throw Error(t.msg||"Payment failed");w({text:"STK Push sent! Check your phone.",type:"success"}),S(f)}catch(e){console.error(e),w({text:`Error: ${e.message}`,type:"error"})}finally{j(!1)}},S=async t=>{let r={items:e.map(e=>({productId:e.id,name:e.name,size:e.size,quantity:e.quantity,price:e.price,image:e.image})),customerName:"Online Customer",phone:t,location:p,subtotal:h,deliveryFee:N,total:k,paymentMethod:"M-Pesa",status:"pending"};try{await fetch("http://localhost:5000/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),x(),setTimeout(()=>u(!1),3e3)}catch(e){console.error("Failed to save order",e)}};return(0,t.jsxs)(t.Fragment,{children:[m&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40 transition-opacity",onClick:()=>u(!1)}),(0,t.jsx)("div",{className:`fixed top-0 right-0 w-full md:w-96 h-full bg-white/20 backdrop-blur-lg z-50 transition-transform duration-300 ease-out border-l border-white/20 shadow-2xl ${m?"translate-x-0":"translate-x-full"}`,children:(0,t.jsxs)("div",{className:"h-full flex flex-col bg-white/80 md:bg-white/60",children:[" ",(0,t.jsxs)("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center bg-white/50",children:[(0,t.jsx)("h3",{className:"text-xl font-bold",children:"Your Cart"}),(0,t.jsx)("button",{onClick:()=>u(!1),className:"text-gray-600 hover:text-black",children:(0,t.jsx)(a.X,{size:24})})]}),(0,t.jsx)("div",{className:"flex-grow overflow-auto p-4",children:0===e.length?(0,t.jsx)("p",{className:"text-gray-500 text-center py-10",children:"Your cart is empty"}):e.map((e,r)=>(0,t.jsxs)("div",{className:"flex items-center py-4 border-b border-gray-200 last:border-0",children:[(0,t.jsx)("div",{className:"w-16 h-16 flex-shrink-0 mr-4",children:(0,t.jsx)("img",{src:e.image,alt:e.name,className:"w-full h-full object-cover rounded"})}),(0,t.jsxs)("div",{className:"flex-grow",children:[(0,t.jsx)("h4",{className:"font-medium text-sm",children:e.name}),(0,t.jsxs)("p",{className:"text-xs text-gray-600",children:["Size: ",e.size]}),(0,t.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,t.jsxs)("div",{className:"flex items-center border rounded bg-white",children:[(0,t.jsx)("button",{onClick:()=>c(e.id,e.size,"decrease"),className:"px-2 py-1 hover:bg-gray-100",children:(0,t.jsx)(n,{size:12})}),(0,t.jsx)("span",{className:"px-2 text-sm",children:e.quantity}),(0,t.jsx)("button",{onClick:()=>c(e.id,e.size,"increase"),className:"px-2 py-1 hover:bg-gray-100",children:(0,t.jsx)(o,{size:12})})]}),(0,t.jsxs)("span",{className:"font-medium text-sm",children:["KES ",(e.price*e.quantity).toFixed(2)]})]})]}),(0,t.jsx)("button",{onClick:()=>l(e.id,e.size),className:"ml-2 text-gray-400 hover:text-red-500",children:(0,t.jsx)(i.Trash2,{size:18})})]},`${e.id}-${e.size}-${r}`))}),(0,t.jsxs)("div",{className:"p-4 border-t border-gray-200 bg-white/50",children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery Location"}),(0,t.jsxs)("select",{value:p,onChange:e=>y(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-black bg-white",children:[(0,t.jsx)("option",{value:"mombasa",children:"Mombasa (Free Delivery)"}),(0,t.jsx)("option",{value:"kilifi",children:"Kilifi (Free Delivery)"}),(0,t.jsx)("option",{value:"other",children:"Other Locations (KES 450 Delivery Fee)"})]})]}),(0,t.jsxs)("div",{className:"space-y-1 mb-4 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Subtotal:"}),(0,t.jsxs)("span",{children:["KES ",h.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Delivery:"}),(0,t.jsxs)("span",{children:["KES ",N.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"flex justify-between font-bold text-base border-t pt-2 mt-2",children:[(0,t.jsx)("span",{children:"Total:"}),(0,t.jsxs)("span",{children:["KES ",k.toFixed(2)]})]})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M-Pesa Phone"}),(0,t.jsx)("input",{type:"tel",placeholder:"2547XXXXXXXX",value:f,onChange:e=>b(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-black"})]}),(0,t.jsx)("button",{onClick:C,disabled:g,className:"w-full bg-green-600 text-white font-medium py-3 rounded-md hover:bg-green-700 transition duration-300 flex items-center justify-center disabled:opacity-70",children:g?"Processing...":(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d,{size:16,className:"mr-2"})," Pay with M-Pesa"]})}),v.text&&(0,t.jsx)("p",{className:`text-sm mt-2 text-center p-2 rounded ${"error"===v.type?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:v.text})]})]})})]})}e.s(["default",()=>c],54628)}]);